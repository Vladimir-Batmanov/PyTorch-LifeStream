## Документация проекта

---

### Описание проекта

**Название проекта:** Прогнозирование покупок клиентов

**Цель проекта:**
Разработать мультимодальную модель, прогнозирующую покупку клиентом каждого из 4 продуктов при их предложении банком. 

### Содержание

1. Описание использованных методов обработки данных
2. Описание методов работы модели/ансамбля моделей
3. Оценка работы модели/ансамбля моделей с указанием итоговой точности модели
4. Скорость обучения и работы модели
5. Дополнительные условия и ограничения, введенные командой для решения задачи

---

### 1. Описание использованных методов обработки данных

#### Предварительная обработка данных

**Нормализация:**
- Приведение всех признаков к единому масштабу для улучшения качества обучения модели.
- Использовалась стандартная нормализация, чтобы каждое значение признака имело среднее значение 0 и стандартное отклонение 1.

**Агрегация и генерация признаков:**
- Создание новых признаков на основе имеющихся данных, таких как суммы, средние значения, максимумы и минимумы транзакций.
- Агрегация данных по клиентам и периодам для создания более информативных признаков.

---

### 2. Описание методов работы модели/ансамбля моделей

#### Создание эмбеддингов с использованием PyTorch Lifestream

**Сбор последовательностей событий:**
- Для каждого клиента собирались данные о его действиях за период.
- Использовались такие события, как транзакции, диалоги с банком и гео-активность.

**Формирование эмбеддингов:**
- Создание эмбеддингов на основе данных за год, начиная с информации о первом месяце и постепенно добавляя данные о последующих месяцах.
- Использовалась библиотека PyTorch и метод PyTorch Lifestream для создания эмбеддингов.

#### Обучение модели CatBoost

**Разделение данных:**
- Данные были разделены на обучающую и тестовую выборки в пропорции 80/20.

**Обучение модели:**
- Модель CatBoost обучалась на обучающих данных с использованием эмбеддингов клиентов.
- Подбор гиперпараметров осуществлялся с помощью библиотеки Optuna.

**Подбор гиперпараметров:**
- Использование библиотеки Optuna для оптимизации гиперпараметров, таких как количество итераций, скорость обучения, глубина деревьев и регуляризация.
- Оптимизация проводилась по метрике log_loss.

---

### 3. Оценка работы модели/ансамбля моделей с указанием итоговой точности модели

**Метрики оценки:**
- Основная метрика: ROC-AUC (0.77)
- Вспомогательные метрики: Accuracy для каждого из 4 таргетов.

**Процесс оценки:**
- Оценка производительности модели на тестовой выборке с использованием ROC-AUC и Accuracy.
- Оценка производительности модели на новых данных и валидация результатов.

**Результаты:**
- ROC-AUC: 0.77
- Accuracy: Значения для каждого из 4 таргетов приведены ниже:
  - target_1: [значение]
  - target_2: [значение]
  - target_3: [значение]
  - target_4: [значение]

---

### 4. Скорость обучения и работы модели

**Скорость обучения:**
- Время обучения модели: [время]
- Использование ресурсов: Обучение проводилось на [указать оборудование], что позволило сократить время обучения.

**Скорость работы:**
- Время предсказания для одного клиента: [время]
- Время предсказания для всего тестового набора: [время]

---

### 5. Дополнительные условия и ограничения, введенные командой для решения задачи

**Ограничения:**
- Данные были анонимизированы и деперсонализированы в соответствии с ФЗ 152 "О персональных данных".
- Обязательное использование библиотеки PyTorch-LifeStream для создания эмбеддингов.
- Модель обучалась только на предоставленных данных, без использования внешних источников информации.

**Дополнительные условия:**
- В случае использования дополнительных данных необходимо аргументировать и оценить их влияние на работу модели.
- Описание сборки и обработки данных для прозрачности и воспроизводимости решения.

---

### Заключение

Разработанная модель демонстрирует высокую точность в прогнозировании покупок клиентов. Использование мультимодальных данных и современных методов машинного обучения позволило достичь значительного улучшения качества предсказаний. В дальнейшем планируется валидация модели на новых данных и внедрение в производственную среду.

---

Эта документация охватывает все ключевые аспекты вашего проекта и демонстрирует его эффективность и инновационность. Если нужно добавить или изменить какие-то детали, дайте знать!